var buttonMenu=document.querySelector(".js-menu-button"),menu=document.querySelector(".header-menu");buttonMenu.addEventListener("click",function(){menu.classList.toggle("header-menu--opened")}),function(){function t(t){this.item=t,this.video=null,this.canvas=null,this.context=null,this.brightness=0,this.contrast=0,this.init()}t.prototype.init=function(){this.video=this.createVideo(),this.initVideo(this.video,this.item.dataset.source),this.canvas=this.item.querySelector("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,this.item.querySelector(".video__player").addEventListener("click",this.show.bind(this)),this.item.querySelector(".video__control--brightness input").addEventListener("change",this.changeBrightness.bind(this)),this.item.querySelector(".video__control--contrast input").addEventListener("change",this.changeContrast.bind(this)),this.video.addEventListener("play",this.onPlay.bind(this))},t.prototype.initVideo=function(t,e){if(Hls.isSupported()){var i=new Hls;i.loadSource(e),i.attachMedia(t),i.on(Hls.Events.MANIFEST_PARSED,function(){t.play()})}else t.canPlayType("application/vnd.apple.mpegurl")&&(t.src="https://video-dev.github.io/streams/x36xhzz/x36xhzz.m3u8",t.addEventListener("loadedmetadata",function(){t.play()}))},t.prototype.createVideo=function(){var t=document.createElement("video");return t.autoPlay=!0,t.loop=!0,t.muted=!0,t},t.prototype.onPlay=function(){var d=this;!function t(){if(!d.video.paused&&!d.video.ended){d.canvas.width=d.canvas.clientWidth,d.canvas.height=d.canvas.clientHeight;var e=1.2*Math.min(d.canvas.width/d.video.videoWidth,d.canvas.height/d.video.videoHeight),i=d.video.videoHeight,n=d.video.videoWidth,o=d.canvas.height/2-i/2*e,a=d.canvas.width/2-n/2*e;d.context.drawImage(d.video,a,o,n*e,i*e);var s=d.context.getImageData(0,0,d.canvas.width,d.canvas.height),r=s.data;d.applyBrightness(r,d.brightness),d.applyContrast(r,parseInt(d.contrast,10)),d.context.putImageData(s,0,0),setTimeout(t,1e3/60)}}()},t.prototype.truncateColor=function(t){return t<0?t=0:255<t&&(t=255),t},t.prototype.applyBrightness=function(t,e){for(var i=0;i<t.length;i+=4)t[i]+=e/100*255,t[i+1]+=e/100*255,t[i+2]+=e/100*255},t.prototype.applyContrast=function(t,e){for(var i=259*(e+255)/(255*(259-e)),n=0;n<t.length;n+=4)t[n]=this.truncateColor(i*(t[n]-128)+128),t[n+1]=this.truncateColor(i*(t[n+1]-128)+128),t[n+2]=this.truncateColor(i*(t[n+2]-128)+128)},t.prototype.changeBrightness=function(t){this.brightness=t.target.value},t.prototype.changeContrast=function(t){this.contrast=t.target.value},t.prototype.show=function(t){var e=t.target.parentNode;e.classList.add("video--show"),this.video.muted=!1,e.querySelector(".video__close").addEventListener("click",this.hide.bind(this))},t.prototype.hide=function(t){var e=t.target.parentNode.parentNode;e.classList.remove("video--show"),e.style="z-index: 666;",this.video.muted=!0,setTimeout(function(){e.style=""},1e3)},window.Video=t}(),function(){function t(){this.init()}t.prototype.init=function(){for(var t=document.querySelectorAll(".video"),e=0;e<t.length;e++)new Video(t[e])},window.VideoController=t}(),new window.VideoController;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZpZGVvLmpzIl0sIm5hbWVzIjpbImJ1dHRvbk1lbnUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJtZW51IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIlZpZGVvIiwiaXRlbSIsInRoaXMiLCJ2aWRlbyIsImNhbnZhcyIsImNvbnRleHQiLCJicmlnaHRuZXNzIiwiY29udHJhc3QiLCJpbml0IiwicHJvdG90eXBlIiwiY3JlYXRlVmlkZW8iLCJpbml0VmlkZW8iLCJkYXRhc2V0Iiwic291cmNlIiwiZ2V0Q29udGV4dCIsIndpZHRoIiwiY2xpZW50V2lkdGgiLCJoZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJzaG93IiwiYmluZCIsImNoYW5nZUJyaWdodG5lc3MiLCJjaGFuZ2VDb250cmFzdCIsIm9uUGxheSIsInVybCIsIkhscyIsImlzU3VwcG9ydGVkIiwiaGxzIiwibG9hZFNvdXJjZSIsImF0dGFjaE1lZGlhIiwib24iLCJFdmVudHMiLCJNQU5JRkVTVF9QQVJTRUQiLCJwbGF5IiwiY2FuUGxheVR5cGUiLCJzcmMiLCJjcmVhdGVFbGVtZW50IiwiYXV0b1BsYXkiLCJsb29wIiwibXV0ZWQiLCJzZWxmIiwicGF1c2VkIiwiZW5kZWQiLCJzY2FsZSIsIk1hdGgiLCJtaW4iLCJ2aWRlb1dpZHRoIiwidmlkZW9IZWlnaHQiLCJ2aWRIIiwidmlkVyIsInRvcCIsImxlZnQiLCJkcmF3SW1hZ2UiLCJpbWFnZURhdGEiLCJnZXRJbWFnZURhdGEiLCJkYXRhIiwiYXBwbHlCcmlnaHRuZXNzIiwiYXBwbHlDb250cmFzdCIsInBhcnNlSW50IiwicHV0SW1hZ2VEYXRhIiwic2V0VGltZW91dCIsInRydW5jYXRlQ29sb3IiLCJ2YWx1ZSIsImkiLCJsZW5ndGgiLCJmYWN0b3IiLCJldmVudCIsInRhcmdldCIsInBhcmVudE5vZGUiLCJhZGQiLCJoaWRlIiwicmVtb3ZlIiwic3R5bGUiLCJ3aW5kb3ciLCJWaWRlb0NvbnRyb2xsZXIiLCJ2aWRlb3MiLCJxdWVyeVNlbGVjdG9yQWxsIiwiayJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsV0FBYUMsU0FBU0MsY0FBYyxtQkFDcENDLEtBQU9GLFNBQVNDLGNBQWMsZ0JBS2xDRixXQUFXSSxpQkFBaUIsUUFBUyxXQUNuQ0QsS0FBS0UsVUFBVUMsT0FBTyx5QkFHdkIsV0FNQyxTQUFTQyxFQUFNQyxHQUNiQyxLQUFLRCxLQUFPQSxFQUNaQyxLQUFLQyxNQUFRLEtBQ2JELEtBQUtFLE9BQVMsS0FDZEYsS0FBS0csUUFBVSxLQUVmSCxLQUFLSSxXQUFhLEVBQ2xCSixLQUFLSyxTQUFXLEVBRWhCTCxLQUFLTSxPQU1QUixFQUFNUyxVQUFVRCxLQUFPLFdBQ3JCTixLQUFLQyxNQUFRRCxLQUFLUSxjQUNsQlIsS0FBS1MsVUFBVVQsS0FBS0MsTUFBT0QsS0FBS0QsS0FBS1csUUFBUUMsUUFFN0NYLEtBQUtFLE9BQVNGLEtBQUtELEtBQUtOLGNBQWMsVUFDdENPLEtBQUtHLFFBQVVILEtBQUtFLE9BQU9VLFdBQVcsTUFFdENaLEtBQUtFLE9BQU9XLE1BQVFiLEtBQUtFLE9BQU9ZLFlBQ2hDZCxLQUFLRSxPQUFPYSxPQUFTZixLQUFLRSxPQUFPYyxhQUVqQ2hCLEtBQUtELEtBQUtOLGNBQWMsa0JBQWtCRSxpQkFBaUIsUUFBU0ssS0FBS2lCLEtBQUtDLEtBQUtsQixPQUNuRkEsS0FBS0QsS0FBS04sY0FBYyxxQ0FBcUNFLGlCQUFpQixTQUFVSyxLQUFLbUIsaUJBQWlCRCxLQUFLbEIsT0FDbkhBLEtBQUtELEtBQUtOLGNBQWMsbUNBQW1DRSxpQkFBaUIsU0FBVUssS0FBS29CLGVBQWVGLEtBQUtsQixPQUUvR0EsS0FBS0MsTUFBTU4saUJBQWlCLE9BQVFLLEtBQUtxQixPQUFPSCxLQUFLbEIsUUFRdkRGLEVBQU1TLFVBQVVFLFVBQVksU0FBVVIsRUFBT3FCLEdBQzNDLEdBQUlDLElBQUlDLGNBQWUsQ0FDckIsSUFBSUMsRUFBTSxJQUFJRixJQUNkRSxFQUFJQyxXQUFXSixHQUNmRyxFQUFJRSxZQUFZMUIsR0FDaEJ3QixFQUFJRyxHQUFHTCxJQUFJTSxPQUFPQyxnQkFBaUIsV0FDakM3QixFQUFNOEIsY0FFQzlCLEVBQU0rQixZQUFZLG1DQUMzQi9CLEVBQU1nQyxJQUFNLDJEQUNaaEMsRUFBTU4saUJBQWlCLGlCQUFrQixXQUN2Q00sRUFBTThCLFdBU1pqQyxFQUFNUyxVQUFVQyxZQUFjLFdBQzVCLElBQUlQLEVBQVFULFNBQVMwQyxjQUFjLFNBTW5DLE9BSkFqQyxFQUFNa0MsVUFBVyxFQUNqQmxDLEVBQU1tQyxNQUFPLEVBQ2JuQyxFQUFNb0MsT0FBUSxFQUVQcEMsR0FNVEgsRUFBTVMsVUFBVWMsT0FBUyxXQUV2QixJQUFJaUIsRUFBT3RDLE1BRVgsU0FBVW9DLElBQ1IsSUFBS0UsRUFBS3JDLE1BQU1zQyxTQUFXRCxFQUFLckMsTUFBTXVDLE1BQU8sQ0FFM0NGLEVBQUtwQyxPQUFPVyxNQUFReUIsRUFBS3BDLE9BQU9ZLFlBQ2hDd0IsRUFBS3BDLE9BQU9hLE9BQVN1QixFQUFLcEMsT0FBT2MsYUFFakMsSUFBSXlCLEVBRTZDLElBRnJDQyxLQUFLQyxJQUNmTCxFQUFLcEMsT0FBT1csTUFBUXlCLEVBQUtyQyxNQUFNMkMsV0FDL0JOLEVBQUtwQyxPQUFPYSxPQUFTdUIsRUFBS3JDLE1BQU00QyxhQUU5QkMsRUFBT1IsRUFBS3JDLE1BQU00QyxZQUNsQkUsRUFBT1QsRUFBS3JDLE1BQU0yQyxXQUNsQkksRUFBTVYsRUFBS3BDLE9BQU9hLE9BQVMsRUFBSytCLEVBQU8sRUFBS0wsRUFDNUNRLEVBQU9YLEVBQUtwQyxPQUFPVyxNQUFRLEVBQUtrQyxFQUFPLEVBQUtOLEVBRWhESCxFQUFLbkMsUUFBUStDLFVBQVVaLEVBQUtyQyxNQUFPZ0QsRUFBTUQsRUFBS0QsRUFBT04sRUFBT0ssRUFBT0wsR0FFbkUsSUFBSVUsRUFBWWIsRUFBS25DLFFBQVFpRCxhQUFhLEVBQUcsRUFBR2QsRUFBS3BDLE9BQU9XLE1BQU95QixFQUFLcEMsT0FBT2EsUUFDM0VzQyxFQUFPRixFQUFVRSxLQUVyQmYsRUFBS2dCLGdCQUFnQkQsRUFBTWYsRUFBS2xDLFlBQ2hDa0MsRUFBS2lCLGNBQWNGLEVBQU1HLFNBQVNsQixFQUFLakMsU0FBVSxLQUVqRGlDLEVBQUtuQyxRQUFRc0QsYUFBYU4sRUFBVyxFQUFHLEdBRXhDTyxXQUFXdEIsRUFBTSxJQUFPLEtBekI1QixJQW1DRnRDLEVBQU1TLFVBQVVvRCxjQUFnQixTQUFVQyxHQU94QyxPQU5JQSxFQUFRLEVBQ1ZBLEVBQVEsRUFDUyxJQUFSQSxJQUNUQSxFQUFRLEtBR0hBLEdBUVQ5RCxFQUFNUyxVQUFVK0MsZ0JBQWtCLFNBQVVELEVBQU1qRCxHQUNoRCxJQUFLLElBQUl5RCxFQUFJLEVBQUdBLEVBQUlSLEVBQUtTLE9BQVFELEdBQUssRUFDcENSLEVBQUtRLElBQWF6RCxFQUFhLElBQXBCLElBQ1hpRCxFQUFLUSxFQUFJLElBQWF6RCxFQUFhLElBQXBCLElBQ2ZpRCxFQUFLUSxFQUFJLElBQWF6RCxFQUFhLElBQXBCLEtBU25CTixFQUFNUyxVQUFVZ0QsY0FBZ0IsU0FBVUYsRUFBTWhELEdBRzlDLElBRkEsSUFBSTBELEVBQVUsS0FBTzFELEVBQVcsTUFBUyxLQUFPLElBQU1BLElBRTdDd0QsRUFBSSxFQUFHQSxFQUFJUixFQUFLUyxPQUFRRCxHQUFLLEVBQ3BDUixFQUFLUSxHQUFLN0QsS0FBSzJELGNBQWNJLEdBQVVWLEVBQUtRLEdBQUssS0FBTyxLQUN4RFIsRUFBS1EsRUFBSSxHQUFLN0QsS0FBSzJELGNBQWNJLEdBQVVWLEVBQUtRLEVBQUksR0FBSyxLQUFPLEtBQ2hFUixFQUFLUSxFQUFJLEdBQUs3RCxLQUFLMkQsY0FBY0ksR0FBVVYsRUFBS1EsRUFBSSxHQUFLLEtBQU8sTUFRcEUvRCxFQUFNUyxVQUFVWSxpQkFBbUIsU0FBVTZDLEdBQzNDaEUsS0FBS0ksV0FBYTRELEVBQU1DLE9BQU9MLE9BT2pDOUQsRUFBTVMsVUFBVWEsZUFBaUIsU0FBVTRDLEdBQ3pDaEUsS0FBS0ssU0FBVzJELEVBQU1DLE9BQU9MLE9BTy9COUQsRUFBTVMsVUFBVVUsS0FBTyxTQUFVK0MsR0FDL0IsSUFBSS9ELEVBQVErRCxFQUFNQyxPQUFPQyxXQUN6QmpFLEVBQU1MLFVBQVV1RSxJQUFJLGVBRXBCbkUsS0FBS0MsTUFBTW9DLE9BQVEsRUFFbkJwQyxFQUFNUixjQUFjLGlCQUFpQkUsaUJBQWlCLFFBQVNLLEtBQUtvRSxLQUFLbEQsS0FBS2xCLFFBT2hGRixFQUFNUyxVQUFVNkQsS0FBTyxTQUFVSixHQUMvQixJQUFJL0QsRUFBUStELEVBQU1DLE9BQU9DLFdBQVdBLFdBQ3BDakUsRUFBTUwsVUFBVXlFLE9BQU8sZUFDdkJwRSxFQUFNcUUsTUFBUSxnQkFFZHRFLEtBQUtDLE1BQU1vQyxPQUFRLEVBRW5CcUIsV0FBVyxXQUNUekQsRUFBTXFFLE1BQVEsSUFDYixNQUdMQyxPQUFPekUsTUFBUUEsRUF0TWpCLEdBME1DLFdBTUMsU0FBUzBFLElBQ1B4RSxLQUFLTSxPQU1Qa0UsRUFBZ0JqRSxVQUFVRCxLQUFPLFdBRy9CLElBRkEsSUFBSW1FLEVBQVNqRixTQUFTa0YsaUJBQWlCLFVBRTlCQyxFQUFJLEVBQUdBLEVBQUlGLEVBQU9YLE9BQVFhLElBQ2pDLElBQUk3RSxNQUFNMkUsRUFBT0UsS0FJckJKLE9BQU9DLGdCQUFrQkEsRUFyQjNCLEdBeUJBLElBQUlELE9BQU9DIiwiZmlsZSI6InZpZGVvLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBidXR0b25NZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLW1lbnUtYnV0dG9uJyk7XG52YXIgbWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXItbWVudScpO1xuXG4vKipcbiAqIEV2ZW50TGlzdGVuZXIgb24gY2xpY2sgbWVudSBidXR0b25cbiAqL1xuYnV0dG9uTWVudS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgbWVudS5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItbWVudS0tb3BlbmVkJyk7XG59KTtcblxuKGZ1bmN0aW9uICgpIHtcblxuICAvKipcbiAgICogVmlkZW9cbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICBmdW5jdGlvbiBWaWRlbyhpdGVtKSB7XG4gICAgdGhpcy5pdGVtID0gaXRlbTtcbiAgICB0aGlzLnZpZGVvID0gbnVsbDtcbiAgICB0aGlzLmNhbnZhcyA9IG51bGw7XG4gICAgdGhpcy5jb250ZXh0ID0gbnVsbDtcblxuICAgIHRoaXMuYnJpZ2h0bmVzcyA9IDA7XG4gICAgdGhpcy5jb250cmFzdCA9IDA7XG5cbiAgICB0aGlzLmluaXQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXphdGlvblxuICAgKi9cbiAgVmlkZW8ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy52aWRlbyA9IHRoaXMuY3JlYXRlVmlkZW8oKTtcbiAgICB0aGlzLmluaXRWaWRlbyh0aGlzLnZpZGVvLCB0aGlzLml0ZW0uZGF0YXNldC5zb3VyY2UpO1xuXG4gICAgdGhpcy5jYW52YXMgPSB0aGlzLml0ZW0ucXVlcnlTZWxlY3RvcignY2FudmFzJyk7XG4gICAgdGhpcy5jb250ZXh0ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgIHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy5jYW52YXMuY2xpZW50V2lkdGg7XG4gICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gdGhpcy5jYW52YXMuY2xpZW50SGVpZ2h0O1xuXG4gICAgdGhpcy5pdGVtLnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fcGxheWVyJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNob3cuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5pdGVtLnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fY29udHJvbC0tYnJpZ2h0bmVzcyBpbnB1dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMuY2hhbmdlQnJpZ2h0bmVzcy5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLml0ZW0ucXVlcnlTZWxlY3RvcignLnZpZGVvX19jb250cm9sLS1jb250cmFzdCBpbnB1dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMuY2hhbmdlQ29udHJhc3QuYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ3BsYXknLCB0aGlzLm9uUGxheS5iaW5kKHRoaXMpKTtcbiAgfTtcblxuICAvKipcbiAgICogSW5pdGlhbGl6YXRpb24gdmlkZW9cbiAgICogQHBhcmFtIHZpZGVvXG4gICAqIEBwYXJhbSB1cmxcbiAgICovXG4gIFZpZGVvLnByb3RvdHlwZS5pbml0VmlkZW8gPSBmdW5jdGlvbiAodmlkZW8sIHVybCkge1xuICAgIGlmIChIbHMuaXNTdXBwb3J0ZWQoKSkge1xuICAgICAgdmFyIGhscyA9IG5ldyBIbHMoKTtcbiAgICAgIGhscy5sb2FkU291cmNlKHVybCk7XG4gICAgICBobHMuYXR0YWNoTWVkaWEodmlkZW8pO1xuICAgICAgaGxzLm9uKEhscy5FdmVudHMuTUFOSUZFU1RfUEFSU0VELCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZpZGVvLnBsYXkoKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAodmlkZW8uY2FuUGxheVR5cGUoJ2FwcGxpY2F0aW9uL3ZuZC5hcHBsZS5tcGVndXJsJykpIHtcbiAgICAgIHZpZGVvLnNyYyA9ICdodHRwczovL3ZpZGVvLWRldi5naXRodWIuaW8vc3RyZWFtcy94MzZ4aHp6L3gzNnhoenoubTN1OCc7XG4gICAgICB2aWRlby5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWRtZXRhZGF0YScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmlkZW8ucGxheSgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGUgdmlkZW8gZWxlbWVudFxuICAgKiBAcmV0dXJucyB7SFRNTEVsZW1lbnR9XG4gICAqL1xuICBWaWRlby5wcm90b3R5cGUuY3JlYXRlVmlkZW8gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHZpZGVvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInZpZGVvXCIpO1xuXG4gICAgdmlkZW8uYXV0b1BsYXkgPSB0cnVlO1xuICAgIHZpZGVvLmxvb3AgPSB0cnVlO1xuICAgIHZpZGVvLm11dGVkID0gdHJ1ZTtcblxuICAgIHJldHVybiB2aWRlbztcbiAgfTtcblxuICAvKipcbiAgICogRHJhdyBmcmFtZVxuICAgKi9cbiAgVmlkZW8ucHJvdG90eXBlLm9uUGxheSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIChmdW5jdGlvbiBsb29wKCkge1xuICAgICAgaWYgKCFzZWxmLnZpZGVvLnBhdXNlZCAmJiAhc2VsZi52aWRlby5lbmRlZCkge1xuXG4gICAgICAgIHNlbGYuY2FudmFzLndpZHRoID0gc2VsZi5jYW52YXMuY2xpZW50V2lkdGg7XG4gICAgICAgIHNlbGYuY2FudmFzLmhlaWdodCA9IHNlbGYuY2FudmFzLmNsaWVudEhlaWdodDtcblxuICAgICAgICB2YXIgc2NhbGUgPSBNYXRoLm1pbihcbiAgICAgICAgICBzZWxmLmNhbnZhcy53aWR0aCAvIHNlbGYudmlkZW8udmlkZW9XaWR0aCxcbiAgICAgICAgICBzZWxmLmNhbnZhcy5oZWlnaHQgLyBzZWxmLnZpZGVvLnZpZGVvSGVpZ2h0KSAqIDEuMjtcblxuICAgICAgICB2YXIgdmlkSCA9IHNlbGYudmlkZW8udmlkZW9IZWlnaHQ7XG4gICAgICAgIHZhciB2aWRXID0gc2VsZi52aWRlby52aWRlb1dpZHRoO1xuICAgICAgICB2YXIgdG9wID0gc2VsZi5jYW52YXMuaGVpZ2h0IC8gMiAtICh2aWRIIC8gMikgKiBzY2FsZTtcbiAgICAgICAgdmFyIGxlZnQgPSBzZWxmLmNhbnZhcy53aWR0aCAvIDIgLSAodmlkVyAvIDIpICogc2NhbGU7XG5cbiAgICAgICAgc2VsZi5jb250ZXh0LmRyYXdJbWFnZShzZWxmLnZpZGVvLCBsZWZ0LCB0b3AsIHZpZFcgKiBzY2FsZSwgdmlkSCAqIHNjYWxlKTtcblxuICAgICAgICB2YXIgaW1hZ2VEYXRhID0gc2VsZi5jb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCBzZWxmLmNhbnZhcy53aWR0aCwgc2VsZi5jYW52YXMuaGVpZ2h0KTtcbiAgICAgICAgdmFyIGRhdGEgPSBpbWFnZURhdGEuZGF0YTtcblxuICAgICAgICBzZWxmLmFwcGx5QnJpZ2h0bmVzcyhkYXRhLCBzZWxmLmJyaWdodG5lc3MpO1xuICAgICAgICBzZWxmLmFwcGx5Q29udHJhc3QoZGF0YSwgcGFyc2VJbnQoc2VsZi5jb250cmFzdCwgMTApKTtcblxuICAgICAgICBzZWxmLmNvbnRleHQucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XG5cbiAgICAgICAgc2V0VGltZW91dChsb29wLCAxMDAwIC8gNjApO1xuICAgICAgfVxuICAgIH0pKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIE1ha2Ugc3VyZSB0aGUgdmFsdWUgc3RheSBiZXR3ZWVuIDAgYW5kIDI1NVxuICAgKiBAcGFyYW0gdmFsdWVcbiAgICogQHJldHVybnMgeyp9XG4gICAqL1xuICBWaWRlby5wcm90b3R5cGUudHJ1bmNhdGVDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA8IDApIHtcbiAgICAgIHZhbHVlID0gMDtcbiAgICB9IGVsc2UgaWYgKHZhbHVlID4gMjU1KSB7XG4gICAgICB2YWx1ZSA9IDI1NTtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldCBicmlnaHRuZXNzXG4gICAqIEBwYXJhbSBkYXRhXG4gICAqIEBwYXJhbSBicmlnaHRuZXNzXG4gICAqL1xuICBWaWRlby5wcm90b3R5cGUuYXBwbHlCcmlnaHRuZXNzID0gZnVuY3Rpb24gKGRhdGEsIGJyaWdodG5lc3MpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpICs9IDQpIHtcbiAgICAgIGRhdGFbaV0gKz0gMjU1ICogKGJyaWdodG5lc3MgLyAxMDApO1xuICAgICAgZGF0YVtpICsgMV0gKz0gMjU1ICogKGJyaWdodG5lc3MgLyAxMDApO1xuICAgICAgZGF0YVtpICsgMl0gKz0gMjU1ICogKGJyaWdodG5lc3MgLyAxMDApO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogU2V0IGNvbnRyYXN0XG4gICAqIEBwYXJhbSBkYXRhXG4gICAqIEBwYXJhbSBjb250cmFzdFxuICAgKi9cbiAgVmlkZW8ucHJvdG90eXBlLmFwcGx5Q29udHJhc3QgPSBmdW5jdGlvbiAoZGF0YSwgY29udHJhc3QpIHtcbiAgICB2YXIgZmFjdG9yID0gKDI1OSAqIChjb250cmFzdCArIDI1NSkpIC8gKDI1NSAqICgyNTkgLSBjb250cmFzdCkpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSArPSA0KSB7XG4gICAgICBkYXRhW2ldID0gdGhpcy50cnVuY2F0ZUNvbG9yKGZhY3RvciAqIChkYXRhW2ldIC0gMTI4KSArIDEyOCk7XG4gICAgICBkYXRhW2kgKyAxXSA9IHRoaXMudHJ1bmNhdGVDb2xvcihmYWN0b3IgKiAoZGF0YVtpICsgMV0gLSAxMjgpICsgMTI4KTtcbiAgICAgIGRhdGFbaSArIDJdID0gdGhpcy50cnVuY2F0ZUNvbG9yKGZhY3RvciAqIChkYXRhW2kgKyAyXSAtIDEyOCkgKyAxMjgpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQ2hhbmdlIGJyaWdodG5lc3NcbiAgICogQHBhcmFtIGV2ZW50XG4gICAqL1xuICBWaWRlby5wcm90b3R5cGUuY2hhbmdlQnJpZ2h0bmVzcyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgIHRoaXMuYnJpZ2h0bmVzcyA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgfTtcblxuICAvKipcbiAgICogQ2hhbmdlIGNvbnRyYXN0XG4gICAqIEBwYXJhbSBldmVudFxuICAgKi9cbiAgVmlkZW8ucHJvdG90eXBlLmNoYW5nZUNvbnRyYXN0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgdGhpcy5jb250cmFzdCA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgfTtcblxuICAvKipcbiAgICogT3BlbiBmdWxsIHZpZGVvXG4gICAqIEBwYXJhbSBldmVudFxuICAgKi9cbiAgVmlkZW8ucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICB2YXIgdmlkZW8gPSBldmVudC50YXJnZXQucGFyZW50Tm9kZTtcbiAgICB2aWRlby5jbGFzc0xpc3QuYWRkKCd2aWRlby0tc2hvdycpO1xuXG4gICAgdGhpcy52aWRlby5tdXRlZCA9IGZhbHNlO1xuXG4gICAgdmlkZW8ucXVlcnlTZWxlY3RvcignLnZpZGVvX19jbG9zZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oaWRlLmJpbmQodGhpcykpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDbG9zZSBmdWxsIHZpZGVvXG4gICAqIEBwYXJhbSBldmVudFxuICAgKi9cbiAgVmlkZW8ucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICB2YXIgdmlkZW8gPSBldmVudC50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgIHZpZGVvLmNsYXNzTGlzdC5yZW1vdmUoJ3ZpZGVvLS1zaG93Jyk7XG4gICAgdmlkZW8uc3R5bGUgPSAnei1pbmRleDogNjY2Oyc7XG5cbiAgICB0aGlzLnZpZGVvLm11dGVkID0gdHJ1ZTtcblxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgdmlkZW8uc3R5bGUgPSAnJztcbiAgICB9LCAxMDAwKTtcbiAgfTtcblxuICB3aW5kb3cuVmlkZW8gPSBWaWRlbztcblxufSgpKTtcblxuKGZ1bmN0aW9uICgpIHtcblxuICAvKipcbiAgICogVmlkZW8gY29udHJvbGxlclxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGZ1bmN0aW9uIFZpZGVvQ29udHJvbGxlcigpIHtcbiAgICB0aGlzLmluaXQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXphdGlvblxuICAgKi9cbiAgVmlkZW9Db250cm9sbGVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB2aWRlb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudmlkZW8nKTtcblxuICAgIGZvciAodmFyIGsgPSAwOyBrIDwgdmlkZW9zLmxlbmd0aDsgaysrKSB7XG4gICAgICBuZXcgVmlkZW8odmlkZW9zW2tdKTtcbiAgICB9XG4gIH07XG5cbiAgd2luZG93LlZpZGVvQ29udHJvbGxlciA9IFZpZGVvQ29udHJvbGxlcjtcblxufSgpKTtcblxubmV3IHdpbmRvdy5WaWRlb0NvbnRyb2xsZXIoKTtcbiJdfQ==
