var buttonMenu=document.querySelector(".js-menu-button"),menu=document.querySelector(".header-menu");buttonMenu.addEventListener("click",function(){menu.classList.toggle("header-menu--opened")}),function(){function t(t){this.item=t,this.video=null,this.canvas=null,this.context=null,this.canvasAudio=null,this.contextAudio=null,this.analyser=null,this.brightness=0,this.contrast=0,this.init()}t.prototype.init=function(){this.video=this.createVideo(),this.initVideo(this.video,this.item.dataset.source),this.canvas=this.item.querySelector("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,this.item.querySelector(".video__player").addEventListener("click",this.show.bind(this)),this.item.querySelector(".video__control--brightness input").addEventListener("change",this.changeBrightness.bind(this)),this.item.querySelector(".video__control--contrast input").addEventListener("change",this.changeContrast.bind(this)),this.video.addEventListener("play",this.onPlay.bind(this)),this.audioAnalyser()},t.prototype.initVideo=function(t,e){if(Hls.isSupported()){var i=new Hls;i.loadSource(e),i.attachMedia(t),i.on(Hls.Events.MANIFEST_PARSED,function(){t.play()})}else t.canPlayType("application/vnd.apple.mpegurl")&&(t.src="https://video-dev.github.io/streams/x36xhzz/x36xhzz.m3u8",t.addEventListener("loadedmetadata",function(){t.play()}))},t.prototype.createVideo=function(){var t=document.createElement("video");return t.autoPlay=!0,t.loop=!0,t.muted=!0,t.preload="auto",t},t.prototype.onPlay=function(){var r=this;!function t(){if(!r.video.paused&&!r.video.ended){r.canvas.width=r.canvas.clientWidth,r.canvas.height=r.canvas.clientHeight;var e=1.2*Math.min(r.canvas.width/r.video.videoWidth,r.canvas.height/r.video.videoHeight),i=r.video.videoHeight,n=r.video.videoWidth,o=r.canvas.height/2-i/2*e,a=r.canvas.width/2-n/2*e;r.context.drawImage(r.video,a,o,n*e,i*e);var s=r.context.getImageData(0,0,r.canvas.width,r.canvas.height),h=s.data;r.applyBrightness(h,r.brightness),r.applyContrast(h,parseInt(r.contrast,10)),r.context.putImageData(s,0,0),setTimeout(t,1e3/60)}}()},t.prototype.truncateColor=function(t){return t<0?t=0:255<t&&(t=255),t},t.prototype.applyBrightness=function(t,e){for(var i=0;i<t.length;i+=4)t[i]+=e/100*255,t[i+1]+=e/100*255,t[i+2]+=e/100*255},t.prototype.applyContrast=function(t,e){for(var i=259*(e+255)/(255*(259-e)),n=0;n<t.length;n+=4)t[n]=this.truncateColor(i*(t[n]-128)+128),t[n+1]=this.truncateColor(i*(t[n+1]-128)+128),t[n+2]=this.truncateColor(i*(t[n+2]-128)+128)},t.prototype.changeBrightness=function(t){this.brightness=t.target.value},t.prototype.changeContrast=function(t){this.contrast=t.target.value},t.prototype.audioAnalyser=function(){var t=new(window.AudioContext||window.webkitAudioContext);this.analyser=t.createAnalyser(),t.createMediaElementSource(this.video).connect(this.analyser),this.analyser.fftSize=256,this.bufferLength=this.analyser.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this.canvasAudio=this.item.querySelector(".video__audio"),this.canvasAudio.width=this.canvasAudio.clientWidth,this.canvasAudio.height=this.canvasAudio.clientHeight,this.contextAudio=this.canvasAudio.getContext("2d"),this.contextAudio.clearRect(0,0,this.canvasAudio.clientWidth,this.canvasAudio.clientHeight),this.analyser.connect(t.destination),this.drawSound()},t.prototype.drawSound=function(){drawVisual=requestAnimationFrame(this.drawSound.bind(this)),this.analyser.getByteFrequencyData(this.dataArray),this.contextAudio.fillStyle="rgba(0, 0, 0, 0.1)",this.contextAudio.fillRect(0,0,this.canvasAudio.clientWidth,this.canvasAudio.clientHeight);for(var t,e=this.canvasAudio.clientWidth/this.bufferLength*2.5,i=0,n=0;n<this.bufferLength;n++)t=this.dataArray[n]/2,this.contextAudio.fillStyle="rgb(50, 50, "+(t+100)+")",this.contextAudio.fillRect(i,this.canvasAudio.clientHeight-t/2,e,t),i+=e+1},t.prototype.show=function(t){var e=t.target.parentNode;if(e.classList.contains("video--show"))return!1;e.classList.add("video--show"),this.video.muted=!1,e.querySelector(".video__close").addEventListener("click",this.hide.bind(this))},t.prototype.hide=function(t){var e=t.target.parentNode.parentNode;e.classList.remove("video--show"),e.style="z-index: 666;",this.video.muted=!0,setTimeout(function(){e.style=""},1e3)},window.Video=t}(),function(){function t(){this.init()}t.prototype.init=function(){for(var t=document.querySelectorAll(".video"),e=0;e<t.length;e++)new Video(t[e])},window.VideoController=t}(),new window.VideoController;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZpZGVvLmpzIl0sIm5hbWVzIjpbImJ1dHRvbk1lbnUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJtZW51IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIlZpZGVvIiwiaXRlbSIsInRoaXMiLCJ2aWRlbyIsImNhbnZhcyIsImNvbnRleHQiLCJjYW52YXNBdWRpbyIsImNvbnRleHRBdWRpbyIsImFuYWx5c2VyIiwiYnJpZ2h0bmVzcyIsImNvbnRyYXN0IiwiaW5pdCIsInByb3RvdHlwZSIsImNyZWF0ZVZpZGVvIiwiaW5pdFZpZGVvIiwiZGF0YXNldCIsInNvdXJjZSIsImdldENvbnRleHQiLCJ3aWR0aCIsImNsaWVudFdpZHRoIiwiaGVpZ2h0IiwiY2xpZW50SGVpZ2h0Iiwic2hvdyIsImJpbmQiLCJjaGFuZ2VCcmlnaHRuZXNzIiwiY2hhbmdlQ29udHJhc3QiLCJvblBsYXkiLCJhdWRpb0FuYWx5c2VyIiwidXJsIiwiSGxzIiwiaXNTdXBwb3J0ZWQiLCJobHMiLCJsb2FkU291cmNlIiwiYXR0YWNoTWVkaWEiLCJvbiIsIkV2ZW50cyIsIk1BTklGRVNUX1BBUlNFRCIsInBsYXkiLCJjYW5QbGF5VHlwZSIsInNyYyIsImNyZWF0ZUVsZW1lbnQiLCJhdXRvUGxheSIsImxvb3AiLCJtdXRlZCIsInByZWxvYWQiLCJzZWxmIiwicGF1c2VkIiwiZW5kZWQiLCJzY2FsZSIsIk1hdGgiLCJtaW4iLCJ2aWRlb1dpZHRoIiwidmlkZW9IZWlnaHQiLCJ2aWRIIiwidmlkVyIsInRvcCIsImxlZnQiLCJkcmF3SW1hZ2UiLCJpbWFnZURhdGEiLCJnZXRJbWFnZURhdGEiLCJkYXRhIiwiYXBwbHlCcmlnaHRuZXNzIiwiYXBwbHlDb250cmFzdCIsInBhcnNlSW50IiwicHV0SW1hZ2VEYXRhIiwic2V0VGltZW91dCIsInRydW5jYXRlQ29sb3IiLCJ2YWx1ZSIsImkiLCJsZW5ndGgiLCJmYWN0b3IiLCJldmVudCIsInRhcmdldCIsImF1ZGlvQ3R4Iiwid2luZG93IiwiQXVkaW9Db250ZXh0Iiwid2Via2l0QXVkaW9Db250ZXh0IiwiY3JlYXRlQW5hbHlzZXIiLCJjcmVhdGVNZWRpYUVsZW1lbnRTb3VyY2UiLCJjb25uZWN0IiwiZmZ0U2l6ZSIsImJ1ZmZlckxlbmd0aCIsImZyZXF1ZW5jeUJpbkNvdW50IiwiZGF0YUFycmF5IiwiVWludDhBcnJheSIsImNsZWFyUmVjdCIsImRlc3RpbmF0aW9uIiwiZHJhd1NvdW5kIiwiZHJhd1Zpc3VhbCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImdldEJ5dGVGcmVxdWVuY3lEYXRhIiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJiYXJIZWlnaHQiLCJiYXJXaWR0aCIsIngiLCJwYXJlbnROb2RlIiwiY29udGFpbnMiLCJhZGQiLCJoaWRlIiwicmVtb3ZlIiwic3R5bGUiLCJWaWRlb0NvbnRyb2xsZXIiLCJ2aWRlb3MiLCJxdWVyeVNlbGVjdG9yQWxsIiwiayJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsV0FBYUMsU0FBU0MsY0FBYyxtQkFDcENDLEtBQU9GLFNBQVNDLGNBQWMsZ0JBS2xDRixXQUFXSSxpQkFBaUIsUUFBUyxXQUNuQ0QsS0FBS0UsVUFBVUMsT0FBTyx5QkFHdkIsV0FNQyxTQUFTQyxFQUFNQyxHQUNiQyxLQUFLRCxLQUFPQSxFQUNaQyxLQUFLQyxNQUFRLEtBQ2JELEtBQUtFLE9BQVMsS0FDZEYsS0FBS0csUUFBVSxLQUVmSCxLQUFLSSxZQUFjLEtBQ25CSixLQUFLSyxhQUFlLEtBQ3BCTCxLQUFLTSxTQUFXLEtBRWhCTixLQUFLTyxXQUFhLEVBQ2xCUCxLQUFLUSxTQUFXLEVBRWhCUixLQUFLUyxPQU1QWCxFQUFNWSxVQUFVRCxLQUFPLFdBQ3JCVCxLQUFLQyxNQUFRRCxLQUFLVyxjQUNsQlgsS0FBS1ksVUFBVVosS0FBS0MsTUFBT0QsS0FBS0QsS0FBS2MsUUFBUUMsUUFFN0NkLEtBQUtFLE9BQVNGLEtBQUtELEtBQUtOLGNBQWMsVUFDdENPLEtBQUtHLFFBQVVILEtBQUtFLE9BQU9h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QUFLQyxNQUFNd0MsT0FBUSxFQUVuQnNCLFdBQVcsV0FDVDlELEVBQU1rRyxNQUFRLElBQ2IsTUFHTDNCLE9BQU8xRSxNQUFRQSxFQW5RakIsR0F1UUMsV0FNQyxTQUFTc0csSUFDUHBHLEtBQUtTLE9BTVAyRixFQUFnQjFGLFVBQVVELEtBQU8sV0FHL0IsSUFGQSxJQUFJNEYsRUFBUzdHLFNBQVM4RyxpQkFBaUIsVUFFOUJDLEVBQUksRUFBR0EsRUFBSUYsRUFBT2xDLE9BQVFvQyxJQUNqQyxJQUFJekcsTUFBTXVHLEVBQU9FLEtBSXJCL0IsT0FBTzRCLGdCQUFrQkEsRUFyQjNCLEdBeUJBLElBQUk1QixPQUFPNEIiLCJmaWxlIjoidmlkZW8ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGJ1dHRvbk1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtbWVudS1idXR0b24nKTtcbnZhciBtZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlci1tZW51Jyk7XG5cbi8qKlxuICogRXZlbnRMaXN0ZW5lciBvbiBjbGljayBtZW51IGJ1dHRvblxuICovXG5idXR0b25NZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICBtZW51LmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1tZW51LS1vcGVuZWQnKTtcbn0pO1xuXG4oZnVuY3Rpb24gKCkge1xuXG4gIC8qKlxuICAgKiBWaWRlb1xuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGZ1bmN0aW9uIFZpZGVvKGl0ZW0pIHtcbiAgICB0aGlzLml0ZW0gPSBpdGVtO1xuICAgIHRoaXMudmlkZW8gPSBudWxsO1xuICAgIHRoaXMuY2FudmFzID0gbnVsbDtcbiAgICB0aGlzLmNvbnRleHQgPSBudWxsO1xuXG4gICAgdGhpcy5jYW52YXNBdWRpbyA9IG51bGw7XG4gICAgdGhpcy5jb250ZXh0QXVkaW8gPSBudWxsO1xuICAgIHRoaXMuYW5hbHlzZXIgPSBudWxsO1xuXG4gICAgdGhpcy5icmlnaHRuZXNzID0gMDtcbiAgICB0aGlzLmNvbnRyYXN0ID0gMDtcblxuICAgIHRoaXMuaW5pdCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemF0aW9uXG4gICAqL1xuICBWaWRlby5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnZpZGVvID0gdGhpcy5jcmVhdGVWaWRlbygpO1xuICAgIHRoaXMuaW5pdFZpZGVvKHRoaXMudmlkZW8sIHRoaXMuaXRlbS5kYXRhc2V0LnNvdXJjZSk7XG5cbiAgICB0aGlzLmNhbnZhcyA9IHRoaXMuaXRlbS5xdWVyeVNlbGVjdG9yKCdjYW52YXMnKTtcbiAgICB0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXG4gICAgdGhpcy5jYW52YXMud2lkdGggPSB0aGlzLmNhbnZhcy5jbGllbnRXaWR0aDtcbiAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLmNhbnZhcy5jbGllbnRIZWlnaHQ7XG5cbiAgICB0aGlzLml0ZW0ucXVlcnlTZWxlY3RvcignLnZpZGVvX19wbGF5ZXInKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuc2hvdy5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLml0ZW0ucXVlcnlTZWxlY3RvcignLnZpZGVvX19jb250cm9sLS1icmlnaHRuZXNzIGlucHV0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5jaGFuZ2VCcmlnaHRuZXNzLmJpbmQodGhpcykpO1xuICAgIHRoaXMuaXRlbS5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX2NvbnRyb2wtLWNvbnRyYXN0IGlucHV0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5jaGFuZ2VDb250cmFzdC5iaW5kKHRoaXMpKTtcblxuICAgIHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcigncGxheScsIHRoaXMub25QbGF5LmJpbmQodGhpcykpO1xuXG4gICAgdGhpcy5hdWRpb0FuYWx5c2VyKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemF0aW9uIHZpZGVvXG4gICAqIEBwYXJhbSB2aWRlb1xuICAgKiBAcGFyYW0gdXJsXG4gICAqL1xuICBWaWRlby5wcm90b3R5cGUuaW5pdFZpZGVvID0gZnVuY3Rpb24gKHZpZGVvLCB1cmwpIHtcbiAgICBpZiAoSGxzLmlzU3VwcG9ydGVkKCkpIHtcbiAgICAgIHZhciBobHMgPSBuZXcgSGxzKCk7XG4gICAgICBobHMubG9hZFNvdXJjZSh1cmwpO1xuICAgICAgaGxzLmF0dGFjaE1lZGlhKHZpZGVvKTtcbiAgICAgIGhscy5vbihIbHMuRXZlbnRzLk1BTklGRVNUX1BBUlNFRCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2aWRlby5wbGF5KCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHZpZGVvLmNhblBsYXlUeXBlKCdhcHBsaWNhdGlvbi92bmQuYXBwbGUubXBlZ3VybCcpKSB7XG4gICAgICB2aWRlby5zcmMgPSAnaHR0cHM6Ly92aWRlby1kZXYuZ2l0aHViLmlvL3N0cmVhbXMveDM2eGh6ei94MzZ4aHp6Lm0zdTgnO1xuICAgICAgdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkbWV0YWRhdGEnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZpZGVvLnBsYXkoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQ3JlYXRlIHZpZGVvIGVsZW1lbnRcbiAgICogQHJldHVybnMge0hUTUxFbGVtZW50fVxuICAgKi9cbiAgVmlkZW8ucHJvdG90eXBlLmNyZWF0ZVZpZGVvID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB2aWRlbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ2aWRlb1wiKTtcblxuICAgIHZpZGVvLmF1dG9QbGF5ID0gdHJ1ZTtcbiAgICB2aWRlby5sb29wID0gdHJ1ZTtcbiAgICB2aWRlby5tdXRlZCA9IHRydWU7XG4gICAgdmlkZW8ucHJlbG9hZCA9ICdhdXRvJztcblxuICAgIHJldHVybiB2aWRlbztcbiAgfTtcblxuICAvKipcbiAgICogRHJhdyBmcmFtZVxuICAgKi9cbiAgVmlkZW8ucHJvdG90eXBlLm9uUGxheSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIChmdW5jdGlvbiBsb29wKCkge1xuICAgICAgaWYgKCFzZWxmLnZpZGVvLnBhdXNlZCAmJiAhc2VsZi52aWRlby5lbmRlZCkge1xuXG4gICAgICAgIHNlbGYuY2FudmFzLndpZHRoID0gc2VsZi5jYW52YXMuY2xpZW50V2lkdGg7XG4gICAgICAgIHNlbGYuY2FudmFzLmhlaWdodCA9IHNlbGYuY2FudmFzLmNsaWVudEhlaWdodDtcblxuICAgICAgICB2YXIgc2NhbGUgPSBNYXRoLm1pbihcbiAgICAgICAgICBzZWxmLmNhbnZhcy53aWR0aCAvIHNlbGYudmlkZW8udmlkZW9XaWR0aCxcbiAgICAgICAgICBzZWxmLmNhbnZhcy5oZWlnaHQgLyBzZWxmLnZpZGVvLnZpZGVvSGVpZ2h0KSAqIDEuMjtcblxuICAgICAgICB2YXIgdmlkSCA9IHNlbGYudmlkZW8udmlkZW9IZWlnaHQ7XG4gICAgICAgIHZhciB2aWRXID0gc2VsZi52aWRlby52aWRlb1dpZHRoO1xuICAgICAgICB2YXIgdG9wID0gc2VsZi5jYW52YXMuaGVpZ2h0IC8gMiAtICh2aWRIIC8gMikgKiBzY2FsZTtcbiAgICAgICAgdmFyIGxlZnQgPSBzZWxmLmNhbnZhcy53aWR0aCAvIDIgLSAodmlkVyAvIDIpICogc2NhbGU7XG5cbiAgICAgICAgc2VsZi5jb250ZXh0LmRyYXdJbWFnZShzZWxmLnZpZGVvLCBsZWZ0LCB0b3AsIHZpZFcgKiBzY2FsZSwgdmlkSCAqIHNjYWxlKTtcblxuICAgICAgICB2YXIgaW1hZ2VEYXRhID0gc2VsZi5jb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCBzZWxmLmNhbnZhcy53aWR0aCwgc2VsZi5jYW52YXMuaGVpZ2h0KTtcbiAgICAgICAgdmFyIGRhdGEgPSBpbWFnZURhdGEuZGF0YTtcblxuICAgICAgICBzZWxmLmFwcGx5QnJpZ2h0bmVzcyhkYXRhLCBzZWxmLmJyaWdodG5lc3MpO1xuICAgICAgICBzZWxmLmFwcGx5Q29udHJhc3QoZGF0YSwgcGFyc2VJbnQoc2VsZi5jb250cmFzdCwgMTApKTtcblxuICAgICAgICBzZWxmLmNvbnRleHQucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XG5cbiAgICAgICAgc2V0VGltZW91dChsb29wLCAxMDAwIC8gNjApO1xuICAgICAgfVxuICAgIH0pKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIE1ha2Ugc3VyZSB0aGUgdmFsdWUgc3RheSBiZXR3ZWVuIDAgYW5kIDI1NVxuICAgKiBAcGFyYW0gdmFsdWVcbiAgICogQHJldHVybnMgeyp9XG4gICAqL1xuICBWaWRlby5wcm90b3R5cGUudHJ1bmNhdGVDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA8IDApIHtcbiAgICAgIHZhbHVlID0gMDtcbiAgICB9IGVsc2UgaWYgKHZhbHVlID4gMjU1KSB7XG4gICAgICB2YWx1ZSA9IDI1NTtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldCBicmlnaHRuZXNzXG4gICAqIEBwYXJhbSBkYXRhXG4gICAqIEBwYXJhbSBicmlnaHRuZXNzXG4gICAqL1xuICBWaWRlby5wcm90b3R5cGUuYXBwbHlCcmlnaHRuZXNzID0gZnVuY3Rpb24gKGRhdGEsIGJyaWdodG5lc3MpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpICs9IDQpIHtcbiAgICAgIGRhdGFbaV0gKz0gMjU1ICogKGJyaWdodG5lc3MgLyAxMDApO1xuICAgICAgZGF0YVtpICsgMV0gKz0gMjU1ICogKGJyaWdodG5lc3MgLyAxMDApO1xuICAgICAgZGF0YVtpICsgMl0gKz0gMjU1ICogKGJyaWdodG5lc3MgLyAxMDApO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogU2V0IGNvbnRyYXN0XG4gICAqIEBwYXJhbSBkYXRhXG4gICAqIEBwYXJhbSBjb250cmFzdFxuICAgKi9cbiAgVmlkZW8ucHJvdG90eXBlLmFwcGx5Q29udHJhc3QgPSBmdW5jdGlvbiAoZGF0YSwgY29udHJhc3QpIHtcbiAgICB2YXIgZmFjdG9yID0gKDI1OSAqIChjb250cmFzdCArIDI1NSkpIC8gKDI1NSAqICgyNTkgLSBjb250cmFzdCkpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSArPSA0KSB7XG4gICAgICBkYXRhW2ldID0gdGhpcy50cnVuY2F0ZUNvbG9yKGZhY3RvciAqIChkYXRhW2ldIC0gMTI4KSArIDEyOCk7XG4gICAgICBkYXRhW2kgKyAxXSA9IHRoaXMudHJ1bmNhdGVDb2xvcihmYWN0b3IgKiAoZGF0YVtpICsgMV0gLSAxMjgpICsgMTI4KTtcbiAgICAgIGRhdGFbaSArIDJdID0gdGhpcy50cnVuY2F0ZUNvbG9yKGZhY3RvciAqIChkYXRhW2kgKyAyXSAtIDEyOCkgKyAxMjgpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQ2hhbmdlIGJyaWdodG5lc3NcbiAgICogQHBhcmFtIGV2ZW50XG4gICAqL1xuICBWaWRlby5wcm90b3R5cGUuY2hhbmdlQnJpZ2h0bmVzcyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgIHRoaXMuYnJpZ2h0bmVzcyA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgfTtcblxuICAvKipcbiAgICogQ2hhbmdlIGNvbnRyYXN0XG4gICAqIEBwYXJhbSBldmVudFxuICAgKi9cbiAgVmlkZW8ucHJvdG90eXBlLmNoYW5nZUNvbnRyYXN0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgdGhpcy5jb250cmFzdCA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgfTtcblxuICAvKipcbiAgICogQXVkaW8gYW5hbHl6ZXJcbiAgICovXG4gIFZpZGVvLnByb3RvdHlwZS5hdWRpb0FuYWx5c2VyID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBhdWRpb0N0eCA9IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0KSgpO1xuICAgIHRoaXMuYW5hbHlzZXIgPSBhdWRpb0N0eC5jcmVhdGVBbmFseXNlcigpO1xuXG4gICAgdmFyIHNvdXJjZSA9IGF1ZGlvQ3R4LmNyZWF0ZU1lZGlhRWxlbWVudFNvdXJjZSh0aGlzLnZpZGVvKTtcbiAgICBzb3VyY2UuY29ubmVjdCh0aGlzLmFuYWx5c2VyKTtcblxuICAgIHRoaXMuYW5hbHlzZXIuZmZ0U2l6ZSA9IDI1NjtcbiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IHRoaXMuYW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnQ7XG4gICAgdGhpcy5kYXRhQXJyYXkgPSBuZXcgVWludDhBcnJheSh0aGlzLmJ1ZmZlckxlbmd0aCk7XG5cbiAgICB0aGlzLmNhbnZhc0F1ZGlvID0gdGhpcy5pdGVtLnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fYXVkaW8nKTtcblxuICAgIHRoaXMuY2FudmFzQXVkaW8ud2lkdGggPSB0aGlzLmNhbnZhc0F1ZGlvLmNsaWVudFdpZHRoO1xuICAgIHRoaXMuY2FudmFzQXVkaW8uaGVpZ2h0ID0gdGhpcy5jYW52YXNBdWRpby5jbGllbnRIZWlnaHQ7XG5cbiAgICB0aGlzLmNvbnRleHRBdWRpbyA9IHRoaXMuY2FudmFzQXVkaW8uZ2V0Q29udGV4dCgnMmQnKTtcbiAgICB0aGlzLmNvbnRleHRBdWRpby5jbGVhclJlY3QoMCwgMCwgdGhpcy5jYW52YXNBdWRpby5jbGllbnRXaWR0aCwgdGhpcy5jYW52YXNBdWRpby5jbGllbnRIZWlnaHQpO1xuXG4gICAgdGhpcy5hbmFseXNlci5jb25uZWN0KGF1ZGlvQ3R4LmRlc3RpbmF0aW9uKTtcblxuICAgIHRoaXMuZHJhd1NvdW5kKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIERyYXcgaGlzdG9ncmFtXG4gICAqL1xuICBWaWRlby5wcm90b3R5cGUuZHJhd1NvdW5kID0gZnVuY3Rpb24gKCkge1xuICAgIGRyYXdWaXN1YWwgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5kcmF3U291bmQuYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLmFuYWx5c2VyLmdldEJ5dGVGcmVxdWVuY3lEYXRhKHRoaXMuZGF0YUFycmF5KTtcblxuICAgIHRoaXMuY29udGV4dEF1ZGlvLmZpbGxTdHlsZSA9ICdyZ2JhKDAsIDAsIDAsIDAuMSknO1xuICAgIHRoaXMuY29udGV4dEF1ZGlvLmZpbGxSZWN0KDAsIDAsIHRoaXMuY2FudmFzQXVkaW8uY2xpZW50V2lkdGgsIHRoaXMuY2FudmFzQXVkaW8uY2xpZW50SGVpZ2h0KTtcbiAgICB2YXIgYmFyV2lkdGggPSAodGhpcy5jYW52YXNBdWRpby5jbGllbnRXaWR0aCAvIHRoaXMuYnVmZmVyTGVuZ3RoKSAqIDIuNTtcbiAgICB2YXIgYmFySGVpZ2h0O1xuICAgIHZhciB4ID0gMDtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5idWZmZXJMZW5ndGg7IGkrKykge1xuICAgICAgYmFySGVpZ2h0ID0gdGhpcy5kYXRhQXJyYXlbaV0gLyAyO1xuXG4gICAgICB0aGlzLmNvbnRleHRBdWRpby5maWxsU3R5bGUgPSAncmdiKCcgKyAnNTAsIDUwLCAnICsgKGJhckhlaWdodCArIDEwMCkgKyAnKSc7XG4gICAgICB0aGlzLmNvbnRleHRBdWRpby5maWxsUmVjdCh4LCB0aGlzLmNhbnZhc0F1ZGlvLmNsaWVudEhlaWdodCAtIGJhckhlaWdodCAvIDIsIGJhcldpZHRoLCBiYXJIZWlnaHQpO1xuXG4gICAgICB4ICs9IGJhcldpZHRoICsgMTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIE9wZW4gZnVsbCB2aWRlb1xuICAgKiBAcGFyYW0gZXZlbnRcbiAgICovXG4gIFZpZGVvLnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgdmFyIHZpZGVvID0gZXZlbnQudGFyZ2V0LnBhcmVudE5vZGU7XG4gICAgaWYgKHZpZGVvLmNsYXNzTGlzdC5jb250YWlucygndmlkZW8tLXNob3cnKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2aWRlby5jbGFzc0xpc3QuYWRkKCd2aWRlby0tc2hvdycpO1xuXG4gICAgdGhpcy52aWRlby5tdXRlZCA9IGZhbHNlO1xuXG4gICAgdmlkZW8ucXVlcnlTZWxlY3RvcignLnZpZGVvX19jbG9zZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oaWRlLmJpbmQodGhpcykpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDbG9zZSBmdWxsIHZpZGVvXG4gICAqIEBwYXJhbSBldmVudFxuICAgKi9cbiAgVmlkZW8ucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICB2YXIgdmlkZW8gPSBldmVudC50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgIHZpZGVvLmNsYXNzTGlzdC5yZW1vdmUoJ3ZpZGVvLS1zaG93Jyk7XG4gICAgdmlkZW8uc3R5bGUgPSAnei1pbmRleDogNjY2Oyc7XG5cbiAgICB0aGlzLnZpZGVvLm11dGVkID0gdHJ1ZTtcblxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgdmlkZW8uc3R5bGUgPSAnJztcbiAgICB9LCAxMDAwKTtcbiAgfTtcblxuICB3aW5kb3cuVmlkZW8gPSBWaWRlbztcblxufSgpKTtcblxuKGZ1bmN0aW9uICgpIHtcblxuICAvKipcbiAgICogVmlkZW8gY29udHJvbGxlclxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGZ1bmN0aW9uIFZpZGVvQ29udHJvbGxlcigpIHtcbiAgICB0aGlzLmluaXQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXphdGlvblxuICAgKi9cbiAgVmlkZW9Db250cm9sbGVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB2aWRlb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudmlkZW8nKTtcblxuICAgIGZvciAodmFyIGsgPSAwOyBrIDwgdmlkZW9zLmxlbmd0aDsgaysrKSB7XG4gICAgICBuZXcgVmlkZW8odmlkZW9zW2tdKTtcbiAgICB9XG4gIH07XG5cbiAgd2luZG93LlZpZGVvQ29udHJvbGxlciA9IFZpZGVvQ29udHJvbGxlcjtcblxufSgpKTtcblxubmV3IHdpbmRvdy5WaWRlb0NvbnRyb2xsZXIoKTtcbiJdfQ==
